# Features

## Основные возможности

### 1. OBS Overlay - Уведомления о донатах
- **URL**: `http://localhost:8080/`
- Показывает GIF/видео с звуком при новом донате
- Выводит имя донатера, сумму, комментарий
- Настраивается время показа в config.yaml

### 2. Donations Feed - Список последних донатов
- **URL**: `http://localhost:8080/feed`
- Прозрачный фон для вставки в стрим
- Автоматически обновляется при новых донатах
- Большой шрифт для чтения со стрима

### 3. YouTube Player - Музыкальный плеер
- Загружает музыку из YouTube ссылок
- Автоматически добавляется из комментария доната
- Проверяет что видео < 10 минут
- Кеширует максимум 10 видео
- CLI интерфейс с командами:
  - `p` - Пауза / Включить
  - `n` - Следующий трек
  - `v+/v-` - Регулировка громкости
  - `q` - Показать очередь
  - `c` - Текущий трек
  - `s` - Выход

### 4. Monobank интеграция
- Автоматически проверяет новые донаты каждые N секунд
- Парсит имя донатера из транзакции
- Поддерживает мультидонаты в одной очереди
- Логирует каждый чек в консоль

## Конфигурация

### config.yaml

```yaml
server:
  port: 8080
  host: localhost
  show_test_button: false

monobank:
  token: "YOUR_TOKEN"
  jar_id: "YOUR_JAR_ID"
  poll_interval: 60

media:
  default_duration: 5000  # миллисекунды
  path: ./media
  rules:
    - min: 0
      max: 4999
      images: ["video/200.gif"]
      sounds: ["audio/sound.mp3"]
```

## Требования

```bash
pip install -r requirements.txt
```

- Python 3.9+
- aiohttp - HTTP сервер
- pyyaml - Конфиг файлы
- yt-dlp - Загрузка YouTube
- pygame - Аудиоплеер

## Запуск

```bash
python main.py
```

## Структура проекта

```
src/
├── config/           - Управление конфигурацией
├── web_host/         - HTTP сервер и websocket
├── media_player/     - Выбор медиа по сумме
├── notification/     - Уведомления и очередь
├── monobank/         - API клиент
├── poller/          - Периодическая проверка
├── donations_feed/  - Список донатов на стрим
└── youtube_player/  - YouTube плеер и очередь
```

## OBS Setup

Добавить две Browser Source:

1. **Overlay**: `http://localhost:8080/`
   - Размер: 1920x1080
   - Отключить интерактивность

2. **Feed**: `http://localhost:8080/feed`
   - Размер: 400x1080
   - Разместить в углу
   - Отключить интерактивность

## YouTube Плеер

Когда приходит донат с комментарием содержащим YouTube ссылку:

```
"Слушайте это! https://youtu.be/dQw4w9WgXcQ"
```

Плеер:
1. Проверяет что видео < 10 минут
2. Добавляет в очередь
3. Скачивает в фоне
4. Воспроизводит через CLI интерфейс

## Логирование

Консоль показывает:
- Проверки Monobank API с временем
- Новые донаты и их детали
- Статус YouTube загрузки
- Сообщения плеера

## Разработка

Каждый модуль содержит `test.py` для тестирования:

```bash
python src/youtube_player/test.py
```
